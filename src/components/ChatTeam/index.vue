<template>
    <div class="content">
        <div class="panel panel-flat">
            <div class="panel-heading">
                <h6 class="panel-title"><b>#ID nhóm chat</b></h6>
                <div class="heading-elements">
                    <ul class="icons-list">
                        <li><a data-action="collapse"></a></li>
                        <li><a data-action="reload"></a></li>
                        <li><a data-action="close"></a></li>
                    </ul>
                </div>
            </div>

            <div class="panel-body">
                <ul class="media-list chat-list content-group">
                    <li class="media date-step">
                        <span>Monday, Feb 10</span>
                    </li>

                    <li class="media">
                        <div class="media-left">
                            <a href="assets/images/placeholder.jpg">
                                <img src="assets/images/placeholder.jpg" class="img-circle" alt="">
                            </a>
                        </div>

                        <div class="media-body">
                            <div class="media-content">Below mounted advantageous spread yikes bat stubbornly crud a and a excepting</div>
                            <span class="media-annotation display-block mt-10">Mon, 9:54 am <a :href="null"><i class="icon-pin-alt position-right text-muted"></i></a></span>
                        </div>
                    </li>

                    <li class="media reversed">
                        <div class="media-body">
                            <div class="media-content">Far squid and that hello fidgeted and when. As this oh darn but slapped casually husky sheared that cardinal hugely one and some unnecessary factiously hedgehog a feeling one rudely much but one owing sympathetic regardless more astonishing evasive tasteful much.</div>
                            <span class="media-annotation display-block mt-10">Mon, 10:24 am <a :href="null"><i class="icon-pin-alt position-right text-muted"></i></a></span>
                        </div>

                        <div class="media-right">
                            <a href="assets/images/placeholder.jpg">
                                <img src="assets/images/placeholder.jpg" class="img-circle" alt="">
                            </a>
                        </div>
                    </li>

                    <li class="media">
                        <div class="media-left">
                            <a href="assets/images/placeholder.jpg">
                                <img src="assets/images/placeholder.jpg" class="img-circle" alt="">
                            </a>
                        </div>

                        <div class="media-body">
                            <div class="media-content">Darn over sour then cynically less roadrunner up some cast buoyant. Macaw krill when and upon less contrary warthog jeez some koala less since therefore minimal.</div>
                            <span class="media-annotation display-block mt-10">Mon, 10:56 am <a :href="null"><i class="icon-pin-alt position-right text-muted"></i></a></span>
                        </div>
                    </li>

                    <li class="media reversed">
                        <div class="media-body">
                            <div class="media-content">Some upset impious a and submissive when far crane the belched coquettishly. More the puerile dove wherever</div>
                            <span class="media-annotation display-block mt-10">Mon, 11:29 am <a :href="null"><i class="icon-pin-alt position-right text-muted"></i></a></span>
                        </div>

                        <div class="media-right">
                            <a href="assets/images/placeholder.jpg">
                                <img src="assets/images/placeholder.jpg" class="img-circle" alt="">
                            </a>
                        </div>
                    </li>

                    <li class="media date-step">
                        <span>Yesterday</span>
                    </li>

                    <li class="media">
                        <div class="media-left">
                            <a href="assets/images/placeholder.jpg">
                                <img src="assets/images/placeholder.jpg" class="img-circle" alt="">
                            </a>
                        </div>

                        <div class="media-body">
                            <div class="media-content">Regardless equitably hello heron glum cassowary jocosely before reliably a jeepers wholehearted shuddered more that some where far by koala.</div>
                            <span class="media-annotation display-block mt-10">Tue, 6:40 am <a :href="null"><i class="icon-pin-alt position-right text-muted"></i></a></span>
                        </div>
                    </li>

                    <li class="media">
                        <div class="media-left">
                            <a href="assets/images/placeholder.jpg">
                                <img src="assets/images/placeholder.jpg" class="img-circle" alt="">
                            </a>
                        </div>

                        <div class="media-body">
                            <div class="media-content">Crud reran and while much withdrew ardent much crab hugely met dizzily that more jeez gent equivalent unsafely far one hesitant so therefore.</div>
                            <span class="media-annotation display-block mt-10">Tue, 10:28 am <a :href="null"><i class="icon-pin-alt position-right text-muted"></i></a></span>
                        </div>
                    </li>

                    <li class="media reversed">
                        <div class="media-body">
                            <div class="media-content">Thus superb the tapir the wallaby blank frog execrably much since dalmatian by in hot. Uninspiringly arose mounted stared one curt safe</div>
                            <span class="media-annotation display-block mt-10">Tue, 8:12 am <a :href="null"><i class="icon-pin-alt position-right text-muted"></i></a></span>
                        </div>

                        <div class="media-right">
                            <a href="assets/images/placeholder.jpg">
                                <img src="assets/images/placeholder.jpg" class="img-circle" alt="">
                            </a>
                        </div>
                    </li>

                    <li class="media date-step">
                        <span>Today</span>
                    </li>

                    <li class="media">
                        <div class="media-left">
                            <a href="assets/images/placeholder.jpg">
                                <img src="assets/images/placeholder.jpg" class="img-circle" alt="">
                            </a>
                        </div>

                        <div class="media-body">
                            <div class="media-content">Tolerantly some understood this stubbornly after snarlingly frog far added insect into snorted more auspiciously heedless drunkenly jeez foolhardy oh.</div>
                            <span class="media-annotation display-block mt-10">Wed, 4:20 pm <a :href="null"><i class="icon-pin-alt position-right text-muted"></i></a></span>
                        </div>
                    </li>

                    <li class="media reversed">
                        <div class="media-body">
                            <div class="message-more-left">
                                <div class="dropdown">
                                    <div class="dropdown-toggle" data-toggle="dropdown">
                                        <span class="icon-menu" style="color: #abb6c6"></span>
                                    </div>
                                    <ul class="dropdown-menu dropdown-menu-left">
                                        <li><a :href="null"><i class="icon-user-lock"></i> Account security</a></li>
                                        <li><a :href="null"><i class="icon-statistics"></i> Analytics</a></li>
                                        <li><a :href="null"><i class="icon-accessibility"></i> Accessibility</a></li>
                                        <li class="divider"></li>
                                        <li><a :href="null"><i class="icon-gear"></i> All settings</a></li>
                                    </ul>
                                </div>
                            </div>

                            <div class="media-content">Satisfactorily strenuously while sleazily dear frustratingly insect menially some shook far sardonic badger telepathic much jeepers immature much hey.</div>
                            <span class="media-annotation display-block mt-10">2 hours ago <a :href="null"><i class="icon-pin-alt position-right text-muted"></i></a></span>
                        </div>

                        <div class="media-right">
                            <a href="assets/images/placeholder.jpg">
                                <img src="assets/images/placeholder.jpg" class="img-circle" alt="">
                            </a>
                        </div>
                    </li>

                    <li class="media">
                        <div class="media-left">
                            <a href="assets/images/placeholder.jpg">
                                <img src="assets/images/placeholder.jpg" class="img-circle" alt="">
                            </a>
                        </div>

                        <div class="media-body">
                            <div class="media-content">Grunted smirked and grew less but rewound much despite and impressive via alongside out and gosh easy manatee dear ineffective yikes.</div>
                            <div class="message-more-right">
                                <i class="icon-menu" style="color:#abb6c6;"></i>
                            </div>
                            <span class="media-annotation display-block mt-10">13 minutes ago <a :href="null"><i class="icon-pin-alt position-right text-muted"></i></a></span>
                        </div>
                    </li>

                    <li class="media reversed">
                        <div class="media-body">
                            <div class="media-content"><i class="icon-menu display-block"></i></div>
                        </div>

                        <div class="media-right">
                            <a href="assets/images/placeholder.jpg">
                                <img src="assets/images/placeholder.jpg" class="img-circle" alt="">
                            </a>
                        </div>
                    </li>
                </ul>
                <div class="popover fade top in pop-tag-member" v-show="showTagFriend == true">
                    <div class="popover-content">
                        <ul class="navigation tag-member">
                            <li v-for="friend in searchFriendTagToMessage" :key="friend.id">
                                <a :href="null">
                                    <div class="media-left">
                                        <img :src="friend.avatar" class="img-circle" alt="">
                                    </div>
                                    <div class="media-body">
                                        @{{friend.name}}
                                    </div>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
                <textarea v-model="textMessage" name="enter-message" class="form-control content-group" rows="3" cols="1" placeholder="Nhập tin nhắn của bạn, gõ @name để tag thành viên..."></textarea>

                <div class="row">
                    <div class="col-xs-6">
                        <ul class="icons-list icons-list-extended mt-10">
                            <li><a :href="null" @click="$refs['input-photo'].click()" data-popup="tooltip" title="Send photo" data-container="body"><i class="icon-file-picture"></i></a></li>
                            <input type="file" ref="input-photo" style="display: none">
                            <li><a :href="null" @click="$refs['input-video'].click()" data-popup="tooltip" title="Send video" data-container="body"><i class="icon-file-video"></i></a></li>
                            <input type="file"  ref="input-video" style="display: none">
                            <li><a :href="null" @click="$refs['input-file'].click()" data-popup="tooltip" title="Send file" data-container="body"><i class="icon-file-plus"></i></a></li>
                            <input type="file" ref="input-file" style="display: none">
                        </ul>
                    </div>

                    <div class="col-xs-6 text-right">
                        <button type="button" class="btn bg-teal-400 btn-labeled btn-labeled-right"><b><i class="icon-circle-right2"></i></b> Send</button>
                    </div>
                </div>
            </div>
        </div>
        <slot></slot>
    </div>
</template>
<script>
import $ from 'jquery'
export default {
  updated () {
    this.$nextTick(function () {
      this.offsetHeightPopTagMember = document.getElementsByClassName('pop-tag-member').item(0).offsetHeight
    })
  },
  computed: {

  },
  watch: {
    textMessage (newText) {
      let arrayText = newText.split('').reverse()
      if (arrayText[0] === '@') {
        this.showTagFriend = true
        let count = this.searchFriendTagToMessage.length
        count = count * 54
        console.dir(document.getElementsByClassName('pop-tag-member').item(0))
        document.getElementsByClassName('pop-tag-member').item(0).style.top = (520 - count).toString() + 'px'
      } else {
        this.showTagFriend = false
      }
    },
    offsetHeightPopTagMember (value) {
      if (value === 300) {
        document.getElementsByClassName('pop-tag-member').item(0).style.top = '240px'
      }
    }
  },
  mounted () {
    let element, name, arr
    element = document.body
    name = 'sidebar-xs'
    arr = element.className.split(' ')
    if (arr.indexOf(name) === -1) {
      element.className += ' ' + name
    }
    let WDWidth = $(window).width()
    let wt = 50
    if (WDWidth < 769) {
      wt = 30
    }
    $('.media-body').hover(function () {
      let widthP = $(this).width()
      let widthC = $(this).children('.media-content').width()
      let paddingLeft = $(this).children('.media-content').css('padding-left')
      let paddingRight = $(this).children('.media-content').css('padding-right')
      $(this).find('.message-more-left').show()
      $(this).find('.message-more-left').css('margin-left', (widthP - widthC - wt - parseFloat(paddingLeft)) + 'px')
      $(this).find('.message-more-right').show()
      $(this).find('.message-more-right').css('margin-right', (widthP - widthC - wt - parseFloat(paddingRight)) + 'px')
    })
    $('.media-body').mouseleave(function () {
      $(this).find('.message-more-left').hide()
      $(this).find('.message-more-right').hide()
    })
  },
  data () {
    return {
      textMessage: '',
      showTagFriend: false,
      searchFriendTagToMessage: [
        {
          id: 1,
          name: 'Cường Đào',
          avatar: 'https://scontent.fhan2-4.fna.fbcdn.net/v/t1.0-1/p50x50/30713129_221639121917111_2265048069710760037_n.jpg?_nc_cat=0&oh=ef29b1adabb59cb6e620eaa19e817ee7&oe=5BFF3C02'
        },
        {
          id: 2,
          name: 'Cường Đào',
          avatar: 'https://scontent.fhan2-4.fna.fbcdn.net/v/t1.0-1/p50x50/30713129_221639121917111_2265048069710760037_n.jpg?_nc_cat=0&oh=ef29b1adabb59cb6e620eaa19e817ee7&oe=5BFF3C02'
        },
        {
          id: 3,
          name: 'Cường Đào',
          avatar: 'https://scontent.fhan2-4.fna.fbcdn.net/v/t1.0-1/p50x50/30713129_221639121917111_2265048069710760037_n.jpg?_nc_cat=0&oh=ef29b1adabb59cb6e620eaa19e817ee7&oe=5BFF3C02'
        },
        {
          id: 4,
          name: 'Cường Đào',
          avatar: 'https://scontent.fhan2-4.fna.fbcdn.net/v/t1.0-1/p50x50/30713129_221639121917111_2265048069710760037_n.jpg?_nc_cat=0&oh=ef29b1adabb59cb6e620eaa19e817ee7&oe=5BFF3C02'
        },
        {
          id: 5,
          name: 'Cường Đào',
          avatar: 'https://scontent.fhan2-4.fna.fbcdn.net/v/t1.0-1/p50x50/30713129_221639121917111_2265048069710760037_n.jpg?_nc_cat=0&oh=ef29b1adabb59cb6e620eaa19e817ee7&oe=5BFF3C02'
        },
        {
          id: 6,
          name: 'Cường Đào',
          avatar: 'https://scontent.fhan2-4.fna.fbcdn.net/v/t1.0-1/p50x50/30713129_221639121917111_2265048069710760037_n.jpg?_nc_cat=0&oh=ef29b1adabb59cb6e620eaa19e817ee7&oe=5BFF3C02'
        },
        {
          id: 7,
          name: 'Cường Đào',
          avatar: 'https://scontent.fhan2-4.fna.fbcdn.net/v/t1.0-1/p50x50/30713129_221639121917111_2265048069710760037_n.jpg?_nc_cat=0&oh=ef29b1adabb59cb6e620eaa19e817ee7&oe=5BFF3C02'
        }
      ],
      offsetHeightPopTagMember: 0
    }
  },
  methods: {
  }
}
</script>
<style>
    .tag-member > li {
        margin-bottom: 10px;
    }
    .tag-member > li > a{
        color: #333333;
        vertical-align: middle;
        line-height: 40px;
        font-size: 15px;
    ;
    }
    .tag-member > li > a:hover{
        color: #333333;
    }
    .pop-tag-member{
        position: absolute;
        display: block;
        left: 20px;
        top:520px;
        max-height: 300px;
        overflow: scroll;
        overflow-x: unset;
    }
    .pop-tag-member::-webkit-scrollbar {
        width: 5px;
    }

    .pop-tag-member::-webkit-scrollbar-track {
        background: #f1f1f1;
    }

    .pop-tag-member::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 10px;
    }

    .pop-tag-member::-webkit-scrollbar-thumb:hover {
        background: #555;
    }
    .pop-tag-member > div{
        padding: 0 !important;
    }
    .tag-member > li > a {
        padding: 0px 15px;
    }
</style>
